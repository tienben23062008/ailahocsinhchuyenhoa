<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ai là học sinh Chuyên Hóa</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    * {
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .fireworks {
      position: fixed;
      inset: 0;
      pointer-events: none;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 40;
    }
    
    .firework-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      opacity: 0;
      animation: burst 0.8s ease-out forwards;
    }
    
    @keyframes burst {
      0% { transform: translate(0, 0) scale(0.4); opacity: 1; }
      60% { opacity: 1; }
      100% { transform: translate(var(--tx), var(--ty)) scale(0.9); opacity: 0; }
    }
    
    .shake {
      animation: shake 0.4s linear;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-6px); }
      40% { transform: translateX(6px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
    }
    
    @keyframes pulse-red {
      0%, 100% { 
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
      }
      50% { 
        transform: scale(1.05);
        box-shadow: 0 0 20px 10px rgba(239, 68, 68, 0);
      }
    }
    
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    
    .timer-urgent {
      animation: pulse-red 1s ease-in-out infinite;
    }
    
    .urgent-warning {
      animation: blink 0.5s ease-in-out infinite;
      font-size: 1.5rem;
      font-weight: 800;
      color: #ef4444;
      text-align: center;
      margin-top: 1rem;
    }
    
    :focus-visible {
      outline: 3px solid #facc15;
      outline-offset: 2px;
    }
    
    .team-selected {
      border: 3px solid #facc15 !important;
      box-shadow: 0 0 20px rgba(250, 204, 21, 0.4);
    }
    
    .chemical-formula {
      background: rgba(100, 116, 139, 0.3);
      padding: 12px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: #fbbf24;
      margin: 8px 0;
      text-align: center;
      border: 1px solid rgba(251, 191, 36, 0.3);
    }
    
    .structure-box {
      background: rgba(30, 41, 59, 0.6);
      padding: 20px;
      border-radius: 12px;
      border: 2px solid rgba(251, 191, 36, 0.3);
      margin: 16px 0;
    }
    
    /* Floating molecules */
    .molecule {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.05));
      border: 2px solid rgba(34, 197, 94, 0.2);
      animation: float 20s infinite ease-in-out;
    }
    
    .molecule::before,
    .molecule::after {
      content: '';
      position: absolute;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.3), rgba(59, 130, 246, 0.05));
      border: 2px solid rgba(59, 130, 246, 0.2);
    }
    
    .molecule::before {
      top: -15px;
      right: -15px;
    }
    
    .molecule::after {
      bottom: -15px;
      left: -15px;
    }
    
    .molecule-1 { top: 10%; left: 5%; animation-delay: 0s; animation-duration: 25s; }
    .molecule-2 { top: 60%; right: 8%; animation-delay: -5s; animation-duration: 30s; }
    .molecule-3 { bottom: 15%; left: 15%; animation-delay: -10s; animation-duration: 28s; }
    .molecule-4 { top: 30%; right: 20%; animation-delay: -15s; animation-duration: 32s; }
    .molecule-5 { bottom: 40%; left: 25%; animation-delay: -8s; animation-duration: 26s; }
    .molecule-6 { top: 75%; right: 30%; animation-delay: -12s; animation-duration: 29s; }
    
    @keyframes float {
      0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }
      25% { transform: translate(30px, -30px) rotate(90deg); opacity: 0.5; }
      50% { transform: translate(-20px, 20px) rotate(180deg); opacity: 0.4; }
      75% { transform: translate(40px, 10px) rotate(270deg); opacity: 0.6; }
    }
    
    /* Chemical symbols */
    .chem-symbol {
      position: absolute;
      font-size: 24px;
      font-weight: bold;
      color: rgba(250, 204, 21, 0.3);
      font-family: 'Courier New', monospace;
      animation: drift 15s infinite ease-in-out;
      text-shadow: 0 0 10px rgba(250, 204, 21, 0.5);
    }
    
    .chem-1 { top: 20%; left: 10%; animation-delay: 0s; }
    .chem-2 { top: 50%; right: 15%; animation-delay: -3s; }
    .chem-3 { bottom: 25%; left: 20%; animation-delay: -6s; }
    .chem-4 { top: 70%; right: 25%; animation-delay: -9s; }
    .chem-5 { top: 40%; left: 30%; animation-delay: -12s; }
    
    @keyframes drift {
      0%, 100% { transform: translate(0, 0); opacity: 0.2; }
      50% { transform: translate(20px, -40px); opacity: 0.4; }
    }
    
    /* Glowing orbs */
    .glow-orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(40px);
      animation: pulse-glow 8s infinite ease-in-out;
    }
    
    .orb-1 {
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(34, 197, 94, 0.15), transparent);
      top: 10%;
      right: 10%;
      animation-delay: 0s;
    }
    
    .orb-2 {
      width: 250px;
      height: 250px;
      background: radial-gradient(circle, rgba(59, 130, 246, 0.12), transparent);
      bottom: 20%;
      left: 15%;
      animation-delay: -3s;
    }
    
    .orb-3 {
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(250, 204, 21, 0.1), transparent);
      top: 50%;
      left: 50%;
      animation-delay: -6s;
    }
    
    @keyframes pulse-glow {
      0%, 100% { transform: scale(1); opacity: 0.3; }
      50% { transform: scale(1.2); opacity: 0.6; }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full"><!-- Animated Background Decorations -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none z-0"><!-- Floating molecules -->
   <div class="molecule molecule-1"></div>
   <div class="molecule molecule-2"></div>
   <div class="molecule molecule-3"></div>
   <div class="molecule molecule-4"></div>
   <div class="molecule molecule-5"></div>
   <div class="molecule molecule-6"></div><!-- Chemical symbols floating -->
   <div class="chem-symbol chem-1">
    H₂O
   </div>
   <div class="chem-symbol chem-2">
    CO₂
   </div>
   <div class="chem-symbol chem-3">
    NaCl
   </div>
   <div class="chem-symbol chem-4">
    CH₄
   </div>
   <div class="chem-symbol chem-5">
    O₂
   </div><!-- Glowing orbs -->
   <div class="glow-orb orb-1"></div>
   <div class="glow-orb orb-2"></div>
   <div class="glow-orb orb-3"></div>
  </div>
  <div id="app" class="h-full w-full flex flex-col bg-gradient-to-br from-slate-900 via-purple-900 via-blue-900 to-emerald-900 relative z-10"><!-- Header -->
   <header class="w-full px-4 sm:px-6 py-4 border-b border-slate-700/50 backdrop-blur-sm bg-slate-900/50">
    <div class="flex items-center justify-between max-w-7xl mx-auto">
     <div class="flex items-center gap-3">
      <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-green-400 to-emerald-600 flex items-center justify-center shadow-lg">
       <svg viewbox="0 0 64 64" class="w-8 h-8"><circle cx="20" cy="20" r="8" fill="#0f172a"></circle> <circle cx="44" cy="20" r="8" fill="#0f172a"></circle> <circle cx="32" cy="40" r="9" fill="#0f172a"></circle> <line x1="20" y1="20" x2="32" y2="40" stroke="#0f172a" stroke-width="3"></line> <line x1="44" y1="20" x2="32" y2="40" stroke="#0f172a" stroke-width="3"></line>
       </svg>
      </div>
      <div>
       <h1 id="main-title" class="text-xl sm:text-2xl font-bold text-white">Ai là học sinh Chuyên Hóa</h1>
       <p id="subtitle" class="text-xs sm:text-sm text-blue-200">Trò chơi trắc nghiệm Hóa Học</p>
      </div>
     </div>
     <div class="hidden lg:flex items-center gap-2">
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 1</span> <span id="score-0" class="text-base font-bold text-yellow-400">0</span>
      </div>
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 2</span> <span id="score-1" class="text-base font-bold text-orange-400">0</span>
      </div>
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 3</span> <span id="score-2" class="text-base font-bold text-teal-400">0</span>
      </div>
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 4</span> <span id="score-3" class="text-base font-bold text-purple-400">0</span>
      </div>
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 5</span> <span id="score-4" class="text-base font-bold text-pink-400">0</span>
      </div>
      <div class="flex flex-col items-center bg-slate-800/60 px-2 py-1.5 rounded-lg border border-slate-700"><span class="text-xs text-slate-400">Lượt 6</span> <span id="score-5" class="text-base font-bold text-blue-400">0</span>
      </div>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="flex-1 overflow-auto px-4 py-6 w-full">
    <div class="max-w-7xl mx-auto grid lg:grid-cols-3 gap-6"><!-- Left Column: Team & Set Selection -->
     <div class="lg:col-span-2 space-y-6"><!-- Team Selection -->
      <section class="bg-slate-800/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-700/50 shadow-xl">
       <h2 class="text-lg font-semibold text-white mb-4">Bước 1: Chọn lượt của bạn</h2>
       <div class="grid grid-cols-2 sm:grid-cols-3 gap-3"><button type="button" onclick="selectTeam(0)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-yellow-500/20 to-yellow-600/10 text-white font-semibold hover:border-yellow-400 transition-all cursor-pointer"> Lượt 1 </button> <button type="button" onclick="selectTeam(1)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-orange-500/20 to-red-600/10 text-white font-semibold hover:border-orange-400 transition-all cursor-pointer"> Lượt 2 </button> <button type="button" onclick="selectTeam(2)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-teal-500/20 to-cyan-600/10 text-white font-semibold hover:border-teal-400 transition-all cursor-pointer"> Lượt 3 </button> <button type="button" onclick="selectTeam(3)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-purple-500/20 to-purple-600/10 text-white font-semibold hover:border-purple-400 transition-all cursor-pointer"> Lượt 4 </button> <button type="button" onclick="selectTeam(4)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-pink-500/20 to-pink-600/10 text-white font-semibold hover:border-pink-400 transition-all cursor-pointer"> Lượt 5 </button> <button type="button" onclick="selectTeam(5)" class="team-btn px-4 py-3 rounded-xl border-2 border-slate-600 bg-gradient-to-br from-blue-500/20 to-blue-600/10 text-white font-semibold hover:border-blue-400 transition-all cursor-pointer"> Lượt 6 </button>
       </div>
       <p id="team-status" class="mt-3 text-sm text-yellow-300">Chưa chọn lượt</p>
      </section><!-- Set Selection -->
      <section class="bg-slate-800/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-700/50 shadow-xl">
       <h2 id="team-section-label" class="text-lg font-semibold text-white mb-4">Bước 2: Chọn bộ câu hỏi</h2>
       <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"><!-- Set 1 -->
        <div id="set-0" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 1</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(0)" class="w-full bg-green-600 hover:bg-green-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div><!-- Set 2 -->
        <div id="set-1" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 2</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(1)" class="w-full bg-orange-600 hover:bg-orange-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div><!-- Set 3 -->
        <div id="set-2" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 3</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(2)" class="w-full bg-teal-600 hover:bg-teal-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div><!-- Set 4 -->
        <div id="set-3" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 4</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(3)" class="w-full bg-purple-600 hover:bg-purple-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div><!-- Set 5 -->
        <div id="set-4" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 5</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(4)" class="w-full bg-blue-600 hover:bg-blue-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div><!-- Set 6 -->
        <div id="set-5" class="set-card bg-slate-900/50 rounded-xl p-4 border border-slate-700">
         <h3 class="text-white font-semibold mb-1">Bộ số 6</h3>
         <p class="text-xs text-slate-400 mb-3">10 câu • 100 điểm • 30 giây</p><button type="button" onclick="startSet(5)" class="w-full bg-pink-600 hover:bg-pink-700 text-white text-sm py-2 px-3 rounded-lg font-semibold transition cursor-pointer"> Bắt đầu </button>
        </div>
       </div>
       <p id="set-status" class="mt-3 text-sm text-yellow-300">Chưa chọn bộ câu hỏi</p>
      </section><!-- Question Panel -->
      <section class="bg-slate-800/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-700/50 shadow-xl">
       <div class="flex items-center justify-between mb-4">
        <h2 id="question-section-label" class="text-lg font-semibold text-white">Câu hỏi hiện tại</h2>
        <div class="flex items-center gap-3">
         <div id="timer-display" class="hidden bg-slate-900/80 px-4 py-2 rounded-lg border border-yellow-400/50">
          <div class="flex items-center gap-2">
           <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
           </svg><span id="timer-text" class="text-xl font-bold text-yellow-400">30</span> <span class="text-sm text-slate-400">giây</span>
          </div>
         </div><span id="question-info" class="text-sm text-slate-400">Chưa bắt đầu</span>
        </div>
       </div>
       <div id="question-panel" class="bg-slate-900/50 rounded-xl p-6 border border-dashed border-slate-700 min-h-[300px] flex flex-col justify-center">
        <p id="question-text" class="text-lg text-white font-medium text-center mb-6">Hãy chọn lượt và bộ câu hỏi để bắt đầu!</p>
        <div id="chemical-display" class="hidden"></div>
        <div id="answers" class="grid sm:grid-cols-2 gap-3"></div>
        <div id="feedback" class="mt-4 text-center font-semibold"></div>
       </div>
       <div class="mt-4 flex items-center justify-between"><span id="attempt-info" class="text-sm text-slate-400">Mỗi câu chỉ có 1 lần trả lời</span>
        <div class="flex gap-2"><button type="button" id="next-btn" onclick="nextQuestion()" disabled class="bg-green-600 hover:bg-green-700 disabled:bg-slate-700 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg text-sm font-medium transition cursor-pointer">Cố lên nha!</button> <button type="button" onclick="resetGame()" class="bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition cursor-pointer"> Chơi lại </button>
        </div>
       </div>
      </section>
     </div><!-- Right Column: Scoreboard -->
     <aside class="lg:col-span-1">
      <div class="bg-slate-800/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-700/50 shadow-xl sticky top-6">
       <h2 id="scoreboard-label" class="text-lg font-semibold text-white mb-4 flex items-center gap-2">Bảng điểm 
        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewbox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
        </svg></h2>
       <div class="space-y-3">
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 1</span> <span id="score-big-0" class="text-xl font-bold text-yellow-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-0" class="h-full bg-gradient-to-r from-yellow-500 to-yellow-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 2</span> <span id="score-big-1" class="text-xl font-bold text-orange-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-1" class="h-full bg-gradient-to-r from-orange-500 to-red-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 3</span> <span id="score-big-2" class="text-xl font-bold text-teal-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-2" class="h-full bg-gradient-to-r from-teal-500 to-cyan-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 4</span> <span id="score-big-3" class="text-xl font-bold text-purple-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-3" class="h-full bg-gradient-to-r from-purple-500 to-purple-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 5</span> <span id="score-big-4" class="text-xl font-bold text-pink-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-4" class="h-full bg-gradient-to-r from-pink-500 to-pink-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
        <div class="bg-slate-900/50 rounded-xl p-3 border border-slate-700">
         <div class="flex items-center justify-between mb-2"><span class="text-sm text-slate-400">Lượt 6</span> <span id="score-big-5" class="text-xl font-bold text-blue-400">0</span>
         </div>
         <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
          <div id="bar-5" class="h-full bg-gradient-to-r from-blue-500 to-blue-600 transition-all duration-500" style="width: 0%"></div>
         </div>
        </div>
       </div>
       <div class="mt-6 pt-4 border-t border-slate-700">
        <p id="footer-text" class="text-xs text-center text-slate-500"></p>
       </div>
      </div>
     </aside>
    </div>
   </main>
  </div>
  <script>
    // Game data - 6 bộ câu hỏi
    const questionSets = [
      {
        name: "Bộ số 1",
        questions: [
          { text: "Câu 1. Polymer là chất rắn trong suốt, có khả năng cho ánh sáng truyền qua tốt nên được dùng để chế tạo thuỷ tinh hữu cơ. Tên gọi của là", answers: ["A. poly(methyl methacrylate)", "B. poly(phenol-formaldehyde)", "C. polyethylene", "D. poly(vinyl chloride)"], correct: 0, points: 10 },
          { text: "Câu 2. Polymer nào dưới đây có thể bị thủy phân cắt mạch polymer?", answers: ["A. Tinh bột", "B. PE", "C. PP", "D. Cao su"], correct: 0, points: 10 },
          { text: "Câu 3. Tơ nylon-6,6 thuộc loại tơ nào sau đây?", answers: ["A. Tơ polyester", "B. Tơ bán tổng hợp", "C. Tơ thiên nhiên", "D. Tơ tổng hợp"], correct: 3, points: 10 },
          { text: "Câu 4. Phân tử polymer nào sau đây chỉ chứa hai loại nguyên tố?", answers: ["A. Poly(methyl methacrylate)", "B. Poly(vinyl chloride)", "C. Polyacrylonitrile", "D. Polypropylene"], correct: 3, points: 10 },
          { text: "Câu 5. Polymer nào sau đây được dùng để chế tạo chất dẻo?", answers: ["A. Polyisoprene", "B. Poly(phenol-formaldehyde)", "C. Polybuta-1,3-diene", "D. Poly(urea-formaldehyde)"], correct: 1, points: 10 },
          { text: "Câu 6. Trùng hợp chất nào sau đây thu được cao su buna?", answers: ["A. CH₂=CCl–CH=CH₂", "B. CH₂=CH–CH=CH₂", "C. CH₂=C(CH₃)–CH=CH₂", "D. CH₂=C(CH₃)–CCl=CH₂"], correct: 1, points: 10 },
          { text: "Câu 7. Polymer là những hợp chất có phân tử khối lớn do nhiều đơn vị nhỏ liên kết với nhau tạo thành. Các đơn vị nhỏ này được gọi là monomer. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 8. Polyisoprene có tính đàn hồi được dùng làm cao su. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 9. Quần áo được dệt bằng sợi len lông cừu, tơ tằm không nên giặt với xà phòng có độ kiềm cao. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 10. Tơ olon được điều chế bằng phản ứng gì?", answers: ["A. Trùng hợp", "B. Trùng ngưng", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      },
      {
        name: "Bộ số 2",
        questions: [
          { text: "Câu 1. Trùng hợp ethylene thu được polymer có tên gọi là", answers: ["A. Polystyrene", "B. Polyethylene", "C. Polypropylene", "D. Poly(vinyl chloride)"], correct: 1, points: 10 },
          { text: "Câu 2. Polymer nào dưới đây có thể bị thủy phân cắt mạch polymer?", answers: ["A. Cellulose", "B. PE", "C. PS", "D. Cao su"], correct: 0, points: 10 },
          { text: "Câu 3. Loại vật liệu nào sau đây không phải là tơ tự nhiên?", answers: ["A. Len", "B. Tơ cellulose acetate", "C. Bông", "D. Tơ tằm"], correct: 1, points: 10 },
          { text: "Câu 4. Polymer nào sau đây có chứa nguyên tố chlorine?", answers: ["A. Poly(methyl methacrylate)", "B. Polyethylene", "C. Polybutadien", "D. Poly(vinyl chloride)"], correct: 3, points: 10 },
          { text: "Câu 5. Polystyrene là chất nhiệt dẻo thường được sử dụng để sản xuất đồ nhựa như li, chén dùng một lần hoặc hộp đựng thức ăn mang về tại các cửa hàng. Monomer được dùng để điều chế PS là", answers: ["A. C₆H₅-CH=CH₂", "B. CH₂=CHCH=CH₂", "C. CH₂=CH₂", "D. CH₂=CHCH₃"], correct: 0, points: 10 },
          { text: "Câu 6. Quá trình cộng hợp liên tiếp nhiều phân tử nhỏ giống nhau hoặc tương tự nhau (monomer) tạo thành phân tử lớn (polymer) được gọi là phản ứng trùng hợp. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 7. Các polymer PE, PVC có khả năng dẫn điện. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 8. Tơ capron và tơ olon đều có thành phần chứa nhóm -CO-NH-. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 9. Trong mủ cao su thiên nhiên, polymer có tính đàn hồi là gì?", answers: ["A. Polyisoprene", "B. Polybutadiene", "C. Polystyrene", "D. Polyethylene"], correct: 0, points: 10 },
          { text: "Câu 10. Tơ lapsan được điều chế bằng phản ứng gì?", answers: ["A. Trùng ngưng", "B. Trùng hợp", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      },
      {
        name: "Bộ số 3",
        questions: [
          { text: "Câu 1. Tên gọi của polymer có công thức -(-CH₂-CH₂-)ₙ- là", answers: ["A. Poly(vinyl chloride)", "B. Polyethylene", "C. Poly(methyl methacrylate)", "D. Polystyrene"], correct: 1, points: 10 },
          { 
            text: "Câu 2. Phản ứng của polyisoprene với bromine xảy ra theo phương trình hóa học sau:", 
            formula: "[-CH₂-C(CH₃)=CH-CH₂-]ₙ + nBr₂ → [-CH₂-C(CH₃)Br-CHBr-CH₂-]ₙ",
            subtext: "Phản ứng trên thuộc loại phản ứng",
            answers: ["A. Cắt mạch polymer", "B. Giữ nguyên mạch polymer", "C. Tăng mạch polymer", "D. Trùng hợp polymer"], 
            correct: 1, 
            points: 10 
          },
          { text: "Câu 3. Sợi visco thuộc loại", answers: ["A. Polymer trùng ngưng", "B. Polymer thiên nhiên", "C. Polymer bán tổng hợp", "D. Polymer tổng hợp"], correct: 2, points: 10 },
          { text: "Câu 4. Loại polymer nào sau đây có chứa nguyên tố nitrogen?", answers: ["A. Polystyrene", "B. Poly(vinyl chloride)", "C. Polyisoprene", "D. Nylon-6,6"], correct: 3, points: 10 },
          { text: "Câu 5. Polypropylene là chất dẻo được sử dụng phổ biến thứ 2 sau polyethylene, được sử dụng để sản xuất các sản phẩm thiết bị y tế, đồ gia dụng... Trùng hợp chất nào sau đây thu được polypropylene?", answers: ["A. CH₂=CH–Cl", "B. CH₂=CH₂", "C. CH₂=CH–C₆H₅", "D. CH₂=CH–CH₃"], correct: 3, points: 10 },
          { text: "Câu 6. Cao su buna-N được tổng hợp bằng cách trùng hợp buta-1,3-diene với chất nào sau đây?", answers: ["A. Isoprene", "B. Sodium", "C. Acrylonitrile", "D. Styrene"], correct: 2, points: 10 },
          { text: "Câu 7. Những polymer khi đun nóng không bị nóng chảy mà bị phân huỷ thì được gọi là chất nhiệt rắn. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 8. Một số polymer có tính dai, bền, có thể kéo sợi như tơ capron, nylon-6,6... Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 9. Tơ nylon, tơ tằm, tơ visco đều bền với nhiệt độ. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 10. PVA được điều chế bằng phản ứng gì?", answers: ["A. Trùng hợp", "B. Trùng ngưng", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      },
      {
        name: "Bộ số 4",
        questions: [
          { 
            text: "Câu 1. Tên gọi của polymer có công thức cho dưới đây là", 
            hasStructure: true,
            structureType: "pvc",
            answers: ["A. Poly(methyl methacrylate)", "B. Poly(vinyl chloride)", "C. Polyethylene", "D. Polystyrene"], 
            correct: 1, 
            points: 10 
          },
          { text: "Câu 2. Quá trình lưu hóa cao su thuộc loại phản ứng", answers: ["A. Cắt mạch polymer", "B. Tăng mạch polymer", "C. Giữ nguyên mạch polymer", "D. Phân hủy polymer"], correct: 1, points: 10 },
          { text: "Câu 3. Tơ nào dưới đây thuộc loại tơ nhân tạo?", answers: ["A. Tơ nylon-6,6", "B. Tơ capron", "C. Tơ tằm", "D. Tơ cellulose acetate"], correct: 3, points: 10 },
          { text: "Câu 4. Polymer nào sau đây trong thành phần chỉ gồm hai nguyên tố C và H?", answers: ["A. Poly(phenol-formaldehyde)", "B. Poly(methyl methacrylate)", "C. Polybuta-1,3-diene", "D. Nylon-6,6"], correct: 2, points: 10 },
          { text: "Câu 5. Hầu hết các polymer tồn tại ở trạng thái", answers: ["A. Rắn", "B. Lỏng", "C. Khí", "D. Không xác định"], correct: 0, points: 10 },
          { 
            text: "Câu 6. Cao su isoprene được tổng hợp từ monomer nào sau đây?", 
            answers: ["A. CH2=CH-CH=CH2", "B. CH2=CCl-CH=CH2", "C. CH2=C(CH3)-CH=CH2", "D. CH2=CH-CH2-CH3"], 
            correct: 2, 
            points: 10 
          },
          { text: "Câu 7. Trùng hợp là quá trình nhiều phân tử nhỏ giống nhau hay tương tự nhau tạo thành phân tử lớn đồng thời giải phóng ra phân tử nhỏ khác (thường là nước). Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 8. Một số polymer trong suốt, có thể cho ánh sáng xuyên qua như poly(methyl methacrylate). Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 9. Sợi visco có thành phần chính là protein đã được xử lý hóa chất. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 10. Cao su Buna-S được điều chế bằng phản ứng đồng trùng hợp", answers: ["A. Trùng hợp", "B. Trùng ngưng", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      },
      {
        name: "Bộ số 5",
        questions: [
          { 
            text: "Câu 1. Tên gọi của polymer có công thức cho dưới đây là", 
            hasStructure: true,
            structureType: "polystyrene",
            answers: ["A. Poly(methyl methacrylate)", "B. Poly(vinyl chloride)", "C. Polyethylene", "D. Polystyrene"], 
            correct: 3, 
            points: 10 
          },
          { text: "Câu 2. Polymer nào dưới đây không bị thủy phân cắt mạch polymer?", answers: ["A. Cellulose", "B. PVC", "C. Capron", "D. Tơ tằm"], correct: 1, points: 10 },
          { text: "Câu 3. Polymer nào sau đây thuộc loại polymer tổng hợp?", answers: ["A. Tinh bột", "B. Tơ tằm", "C. Polyethylene", "D. Cao su thiên nhiên"], correct: 2, points: 10 },
          { text: "Câu 4. Polymer nào sau đây trong thành phần chỉ gồm hai nguyên tố C và H?", answers: ["A. Poly(phenol-formaldehyde)", "B. Poly(methyl methacrylate)", "C. Polybuta-1,3-diene", "D. Nylon-6,6"], correct: 2, points: 10 },
          { text: "Câu 5. Nhiệt độ nóng chảy của các polymer có đặc điểm nào dưới đây?", answers: ["A. Cao", "B. Thấp", "C. Cố định", "D. Không xác định"], correct: 3, points: 10 },
          { text: "Câu 6. Cao su lưu hóa thu được khi cho cao su tác dụng với chất nào sau đây?", answers: ["A. Lưu huỳnh", "B. Na2SO3", "C. Na2SO4", "D. Styrene"], correct: 0, points: 10 },
          { text: "Câu 7. Tơ nylon-6,6 và tơ capron thuộc loại tơ polyamide. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 8. Keo dán là vật liệu polymer có thành phần gồm vật liệu cốt và vật liệu nền là chất kết dính. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 9. Đa số polymer có tính đàn hồi như polyethylene, polybuta-1,3-diene. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 10. Nylon-6,6 được điều chế bằng phản ứng", answers: ["A. Trùng ngưng", "B. Trùng hợp", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      },
      {
        name: "Bộ số 6",
        questions: [
          { 
            text: "Câu 1. Tên gọi của polymer có công thức cho dưới đây là", 
            hasStructure: true,
            structureType: "nylon66",
            answers: ["A. Nylon-6", "B. Nylon-7", "C. Nylon-6,6", "D. Olon"], 
            correct: 2, 
            points: 10 
          },
          { 
            text: "Câu 2. Phản ứng phân hủy polystyrene xảy ra theo phương trình hóa học sau:", 
            formula: "[-CH₂-CH(C₆H₅)-]ₙ → n C₆H₅-CH=CH₂",
            subtext: "Phản ứng trên thuộc loại phản ứng",
            answers: ["A. Cắt mạch polymer", "B. Giữ nguyên mạch polymer", "C. Tăng mạch polymer", "D. Trùng hợp polymer"], 
            correct: 0, 
            points: 10 
          },
          { text: "Câu 3. Tơ sợi nào sau đây thuộc loại tơ tự nhiên?", answers: ["A. Sợi bông", "B. Nitron", "C. Nylon-6,6", "D. Cellulose acetate"], correct: 0, points: 10 },
          { text: "Câu 4. Polymer nào sau đây có chứa nguyên tố nitrogen?", answers: ["A. Polybuta-1,3-diene", "B. Polyacrylonitrile", "C. Polyethylene", "D. Poly(vinyl chloride)"], correct: 1, points: 10 },
          { text: "Câu 5. Chất dẻo PVC là chất rắn vô định hình, cách điện tốt, bền với acid, được dùng làm vật liệu cách điện, ống dẫn nước, vải che mưa... PVC được tổng hợp trực tiếp từ monomer nào sau đây?", answers: ["A. Acrylonitrile", "B. Vinyl chloride", "C. Vinyl acetate", "D. Propylene"], correct: 1, points: 10 },
          { text: "Câu 6. Tơ là vật liệu polymer hình sợi, dài, mảnh, có độ bền nhất định, mạch không nhánh. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 7. PPF có tính cách điện, chịu được nhiệt độ cao và chống cháy nên được dùng để chế tạo vật liệu bán dẫn. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 1, points: 10 },
          { text: "Câu 8. Tơ nitron dai, bền với nhiệt, giữ nhiệt tốt, thường được dùng để dệt vải và may quần áo ấm. Đúng hay sai?", answers: ["A. Đúng", "B. Sai"], correct: 0, points: 10 },
          { text: "Câu 9. Cao su buna-S là sản phẩm đồng trùng hợp của buta-1,3-diene và chất nào?", answers: ["A. Styrene", "B. Acrylonitrile", "C. Isoprene", "D. Chloroprene"], correct: 0, points: 10 },
          { text: "Câu 10. Thủy tinh hữu cơ được điều chế bằng phản ứng gì?", answers: ["A. Trùng hợp", "B. Trùng ngưng", "C. Thủy phân", "D. Oxi hóa"], correct: 0, points: 10 }
        ]
      }
    ];

    // Game state
    let scores = [0, 0, 0, 0, 0, 0];
    let currentTeam = null;
    let currentSet = null;
    let currentQuestion = 0;

    let usedSets = new Set();
    let answered = false;
    let gameActive = false;
    
    let timeRemaining = 30;
    let timerInterval = null;



    function showFireworks() {
      const container = document.createElement('div');
      container.className = 'fireworks';
      for (let i = 0; i < 16; i++) {
        const dot = document.createElement('div');
        dot.className = 'firework-dot';
        const angle = (Math.PI * 2 * i) / 16;
        const dist = 80 + Math.random() * 40;
        dot.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
        dot.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
        dot.style.backgroundColor = i % 2 === 0 ? '#22c55e' : '#facc15';
        container.appendChild(dot);
      }
      document.body.appendChild(container);
      setTimeout(() => container.remove(), 900);
    }

    function shakePanel() {
      const panel = document.getElementById('question-panel');
      panel.classList.add('shake');
      setTimeout(() => panel.classList.remove('shake'), 400);
    }
    
    function startTimer() {
      stopTimer();
      timeRemaining = 30;
      document.getElementById('timer-text').textContent = timeRemaining;
      document.getElementById('timer-display').classList.remove('hidden');
      
      timerInterval = setInterval(() => {
        timeRemaining--;
        document.getElementById('timer-text').textContent = timeRemaining;
        
        if (timeRemaining <= 5) {
          document.getElementById('timer-text').style.color = '#ef4444';
          document.getElementById('timer-display').style.borderColor = '#ef4444';
          document.getElementById('timer-display').classList.add('timer-urgent');
          
          const panel = document.getElementById('question-panel');
          panel.style.borderColor = '#ef4444';
          panel.style.borderWidth = '3px';
          
          if (timeRemaining <= 3) {
            panel.classList.add('shake');
            setTimeout(() => panel.classList.remove('shake'), 400);
          }
        }
        
        if (timeRemaining <= 0) {
          stopTimer();
          endSet();
        }
      }, 1000);
    }
    
    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      document.getElementById('timer-display').classList.add('hidden');
      document.getElementById('timer-display').classList.remove('timer-urgent');
      document.getElementById('timer-text').style.color = '#facc15';
      document.getElementById('timer-display').style.borderColor = 'rgba(250, 204, 21, 0.5)';
      
      const panel = document.getElementById('question-panel');
      panel.style.borderColor = '';
      panel.style.borderWidth = '';
      
      const warningEl = document.getElementById('urgent-warning');
      if (warningEl) {
        warningEl.remove();
      }
    }
    
    function endSet() {
      if (!gameActive || currentSet === null) return;
      
      const set = questionSets[currentSet];
      usedSets.add(currentSet);
      document.getElementById('set-' + currentSet).style.opacity = '0.5';
      document.getElementById('set-' + currentSet).style.pointerEvents = 'none';
      
      stopTimer();
      
      document.getElementById('question-text').textContent = 'Hết giờ! Đã hoàn thành ' + set.name + '. Điểm của bạn: ' + scores[currentTeam] + ' điểm';
      document.getElementById('answers').innerHTML = '';
      document.getElementById('feedback').textContent = '';
      document.getElementById('question-info').textContent = 'Hoàn thành';
      document.getElementById('chemical-display').classList.add('hidden');
      
      gameActive = false;
      currentSet = null;
    }

    function updateScores() {
      for (let i = 0; i < 6; i++) {
        document.getElementById('score-' + i).textContent = scores[i];
        document.getElementById('score-big-' + i).textContent = scores[i];
        const percent = Math.min(100, (scores[i] / 600) * 100);
        document.getElementById('bar-' + i).style.width = percent + '%';
      }
    }

    function selectTeam(index) {
      currentTeam = index;
      const teamNames = ['Lượt 1', 'Lượt 2', 'Lượt 3', 'Lượt 4', 'Lượt 5', 'Lượt 6'];
      document.getElementById('team-status').textContent = 'Đã chọn: ' + teamNames[index];
      document.getElementById('team-status').style.color = '#22c55e';
      
      const buttons = document.querySelectorAll('.team-btn');
      buttons.forEach((btn, i) => {
        if (i === index) {
          btn.classList.add('team-selected');
        } else {
          btn.classList.remove('team-selected');
        }
      });
    }

    function startSet(index) {
      if (currentTeam === null) {
        document.getElementById('set-status').textContent = 'Vui lòng chọn lượt trước!';
        document.getElementById('set-status').style.color = '#f87171';
        return;
      }
      
      if (usedSets.has(index)) {
        document.getElementById('set-status').textContent = 'Bộ này đã được sử dụng!';
        document.getElementById('set-status').style.color = '#f87171';
        return;
      }

      currentSet = index;
      currentQuestion = 0;
      answered = false;
      gameActive = true;

      document.getElementById('set-status').textContent = 'Đang chơi: ' + questionSets[index].name + ' (30 giây)';
      document.getElementById('set-status').style.color = '#22c55e';

      startTimer();
      renderQuestion();
    }

    function renderQuestion() {
      if (!gameActive || currentSet === null) {
        document.getElementById('question-text').textContent = 'Hãy chọn lượt và bộ câu hỏi để bắt đầu!';
        document.getElementById('answers').innerHTML = '';
        document.getElementById('feedback').textContent = '';
        document.getElementById('question-info').textContent = 'Chưa bắt đầu';
        document.getElementById('attempt-info').textContent = 'Bạn có 30 giây để trả lời tất cả câu hỏi';
        document.getElementById('chemical-display').classList.add('hidden');
        stopTimer();
        return;
      }

      const set = questionSets[currentSet];
      if (currentQuestion >= set.questions.length) {
        usedSets.add(currentSet);
        document.getElementById('set-' + currentSet).style.opacity = '0.5';
        document.getElementById('set-' + currentSet).style.pointerEvents = 'none';
        
        stopTimer();
        
        document.getElementById('question-text').textContent = 'Đã hoàn thành ' + set.name + '! Điểm của bạn: ' + scores[currentTeam] + ' điểm';
        document.getElementById('answers').innerHTML = '';
        document.getElementById('feedback').textContent = '';
        document.getElementById('question-info').textContent = 'Hoàn thành';
        document.getElementById('chemical-display').classList.add('hidden');
        
        gameActive = false;
        currentSet = null;
        return;
      }

      const q = set.questions[currentQuestion];
      
      // Display question text
      document.getElementById('question-text').textContent = q.text;
      
      // Display chemical structures
      const chemDisplay = document.getElementById('chemical-display');
      if (q.hasStructure && q.structureType === 'pvc') {
        chemDisplay.innerHTML = `
          <div class="structure-box">
            <p class="text-yellow-300 text-sm mb-4 text-center font-semibold">Công thức cấu tạo của polymer:</p>
            <svg viewBox="0 0 400 180" class="w-full max-w-xl mx-auto">
              <!-- Dấu ngoặc vuông trái -->
              <text x="20" y="75" fill="#fbbf24" font-size="60" font-family="Arial" font-weight="bold">[</text>
              
              <!-- Nhánh trái -->
              <line x1="60" y1="60" x2="100" y2="60" stroke="#fbbf24" stroke-width="3"/>
              
              <!-- CH2 bên trái -->
              <text x="95" y="50" fill="#fbbf24" font-size="20" font-family="Arial" font-weight="bold">CH</text>
              <text x="125" y="55" fill="#fbbf24" font-size="16" font-family="Arial">2</text>
              
              <!-- Liên kết ngang giữa CH2 và CH -->
              <line x1="145" y1="60" x2="185" y2="60" stroke="#fbbf24" stroke-width="3"/>
              
              <!-- CH ở giữa -->
              <text x="185" y="50" fill="#fbbf24" font-size="20" font-family="Arial" font-weight="bold">CH</text>
              
              <!-- Liên kết dọc xuống Cl -->
              <line x1="200" y1="60" x2="200" y2="100" stroke="#fbbf24" stroke-width="3"/>
              
              <!-- Cl ở dưới -->
              <text x="190" y="125" fill="#10b981" font-size="20" font-family="Arial" font-weight="bold">Cl</text>
              
              <!-- Nhánh phải -->
              <line x1="215" y1="60" x2="260" y2="60" stroke="#fbbf24" stroke-width="3"/>
              
              <!-- Dấu ngoặc vuông phải -->
              <text x="265" y="75" fill="#fbbf24" font-size="60" font-family="Arial" font-weight="bold">]</text>
              
              <!-- Chỉ số n -->
              <text x="325" y="75" fill="#fbbf24" font-size="24" font-family="Arial" font-style="italic" font-weight="bold">n</text>
            </svg>
          </div>
        `;
        chemDisplay.classList.remove('hidden');
      } else if (q.hasStructure && q.structureType === 'polystyrene') {
        chemDisplay.innerHTML = `
          <div class="structure-box">
            <p class="text-yellow-300 text-sm mb-4 text-center font-semibold">Công thức cấu tạo của polymer:</p>
            <div class="chemical-formula text-2xl">
              [-(C₆H₅-CH=CH₂)-]<sub>n</sub>
            </div>
          </div>
        `;
        chemDisplay.classList.remove('hidden');
      } else if (q.hasStructure && q.structureType === 'nylon66') {
        chemDisplay.innerHTML = `
          <div class="structure-box">
            <p class="text-yellow-300 text-sm mb-4 text-center font-semibold">Công thức cấu tạo của polymer:</p>
            <svg viewBox="0 0 600 140" class="w-full max-w-3xl mx-auto">
              <!-- Dấu ngoặc vuông trái -->
              <text x="10" y="70" fill="#fbbf24" font-size="50" font-family="Arial" font-weight="bold">[</text>
              
              <!-- Nhóm -NH- -->
              <text x="40" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">NH</text>
              
              <!-- Liên kết đơn -->
              <line x1="70" y1="55" x2="90" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
              
              <!-- (CH2)6 -->
              <text x="90" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">(CH</text>
              <text x="130" y="70" fill="#fbbf24" font-size="14" font-family="Arial">2</text>
              <text x="142" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">)</text>
              <text x="152" y="70" fill="#fbbf24" font-size="14" font-family="Arial">6</text>
              
              <!-- Liên kết đơn -->
              <line x1="170" y1="55" x2="190" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
              
              <!-- Nhóm -NH- -->
              <text x="190" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">NH</text>
              
              <!-- Liên kết đơn -->
              <line x1="220" y1="55" x2="240" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
              
              <!-- Nhóm -CO- -->
              <text x="240" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">CO</text>
              
              <!-- Liên kết đơn -->
              <line x1="275" y1="55" x2="295" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
              
              <!-- (CH2)4 -->
              <text x="295" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">(CH</text>
              <text x="335" y="70" fill="#fbbf24" font-size="14" font-family="Arial">2</text>
              <text x="347" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">)</text>
              <text x="357" y="70" fill="#fbbf24" font-size="14" font-family="Arial">4</text>
              
              <!-- Liên kết đơn -->
              <line x1="375" y1="55" x2="395" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
              
              <!-- Nhóm -CO- -->
              <text x="395" y="65" fill="#fbbf24" font-size="18" font-family="Arial" font-weight="bold">CO</text>
              
              <!-- Dấu ngoặc vuông phải -->
              <text x="435" y="70" fill="#fbbf24" font-size="50" font-family="Arial" font-weight="bold">]</text>
              
              <!-- Chỉ số n -->
              <text x="480" y="70" fill="#fbbf24" font-size="22" font-family="Arial" font-style="italic" font-weight="bold">n</text>
            </svg>
          </div>
        `;
        chemDisplay.classList.remove('hidden');
      } else if (q.hasStructure && q.structureType === 'isoprene_options') {
        chemDisplay.innerHTML = `
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 my-4">
            <!-- Option A: Butadiene -->
            <div class="structure-box">
              <p class="text-yellow-300 text-xs mb-2 text-center font-semibold">Đáp án A:</p>
              <svg viewBox="0 0 280 100" class="w-full h-auto mx-auto">
                <line x1="40" y1="50" x2="70" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="70" cy="50" r="3" fill="#fbbf24"/>
                <line x1="70" y1="50" x2="100" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="75" y1="55" x2="95" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="100" cy="50" r="3" fill="#fbbf24"/>
                <line x1="100" y1="50" x2="130" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="130" cy="50" r="3" fill="#fbbf24"/>
                <line x1="130" y1="50" x2="160" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="135" y1="55" x2="155" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="160" cy="50" r="3" fill="#fbbf24"/>
                <line x1="160" y1="50" x2="190" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <text x="30" y="45" fill="#94a3b8" font-size="14">H₂</text>
                <text x="180" y="45" fill="#94a3b8" font-size="14">H2</text>
              </svg>
              <p class="text-slate-400 text-xs mt-1 text-center">CH₂=CH-CH=CH₂</p>
            </div>
            
            <!-- Option B: Chloroprene -->
            <div class="structure-box">
              <p class="text-yellow-300 text-xs mb-2 text-center font-semibold">Đáp án B:</p>
              <svg viewBox="0 0 280 100" class="w-full h-auto mx-auto">
                <line x1="40" y1="50" x2="70" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="70" cy="50" r="3" fill="#fbbf24"/>
                <line x1="70" y1="50" x2="100" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="75" y1="55" x2="95" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="100" cy="50" r="3" fill="#fbbf24"/>
                <line x1="100" y1="50" x2="100" y2="25" stroke="#fbbf24" stroke-width="2.5"/>
                <text x="95" y="20" fill="#10b981" font-size="14" font-weight="bold">Cl</text>
                <line x1="100" y1="50" x2="130" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="130" cy="50" r="3" fill="#fbbf24"/>
                <line x1="130" y1="50" x2="160" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="135" y1="55" x2="155" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="160" cy="50" r="3" fill="#fbbf24"/>
                <line x1="160" y1="50" x2="190" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <text x="30" y="45" fill="#94a3b8" font-size="14">H₂</text>
                <text x="180" y="45" fill="#94a3b8" font-size="14">H2</text>
              </svg>
              <p class="text-slate-400 text-xs mt-1 text-center">CH₂=CCl-CH=CH₂</p>
            </div>
            
            <!-- Option C: Isoprene -->
            <div class="structure-box border-2 border-green-500/50">
              <p class="text-green-400 text-xs mb-2 text-center font-semibold">Đáp án C: ✓ Isoprene</p>
              <svg viewBox="0 0 280 100" class="w-full h-auto mx-auto">
                <line x1="40" y1="50" x2="70" y2="50" stroke="#22c55e" stroke-width="2.5"/>
                <circle cx="70" cy="50" r="3" fill="#22c55e"/>
                <line x1="70" y1="50" x2="100" y2="50" stroke="#22c55e" stroke-width="2.5"/>
                <line x1="75" y1="55" x2="95" y2="55" stroke="#22c55e" stroke-width="2.5"/>
                <circle cx="100" cy="50" r="3" fill="#22c55e"/>
                <line x1="100" y1="50" x2="100" y2="25" stroke="#22c55e" stroke-width="2.5"/>
                <text x="90" y="20" fill="#94a3b8" font-size="14">CH₃</text>
                <line x1="100" y1="50" x2="130" y2="50" stroke="#22c55e" stroke-width="2.5"/>
                <circle cx="130" cy="50" r="3" fill="#22c55e"/>
                <line x1="130" y1="50" x2="160" y2="50" stroke="#22c55e" stroke-width="2.5"/>
                <line x1="135" y1="55" x2="155" y2="55" stroke="#22c55e" stroke-width="2.5"/>
                <circle cx="160" cy="50" r="3" fill="#22c55e"/>
                <line x1="160" y1="50" x2="190" y2="50" stroke="#22c55e" stroke-width="2.5"/>
                <text x="30" y="45" fill="#94a3b8" font-size="14">H₂</text>
                <text x="180" y="45" fill="#94a3b8" font-size="14">H₂</text>
              </svg>
              <p class="text-slate-400 text-xs mt-1 text-center">CH₂=C(CH₃)-CH=CH₂</p>
            </div>
            
            <!-- Option D: Butene -->
            <div class="structure-box">
              <p class="text-yellow-300 text-xs mb-2 text-center font-semibold">Đáp án D:</p>
              <svg viewBox="0 0 280 100" class="w-full h-auto mx-auto">
                <line x1="40" y1="50" x2="70" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="70" cy="50" r="3" fill="#fbbf24"/>
                <line x1="70" y1="50" x2="100" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="75" y1="55" x2="95" y2="55" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="100" cy="50" r="3" fill="#fbbf24"/>
                <line x1="100" y1="50" x2="130" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="130" cy="50" r="3" fill="#fbbf24"/>
                <line x1="130" y1="50" x2="160" y2="50" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="160" cy="50" r="3" fill="#fbbf24"/>
                <text x="30" y="45" fill="#94a3b8" font-size="14">H₂</text>
                <text x="150" y="45" fill="#94a3b8" font-size="14">H₃</text>
              </svg>
              <p class="text-slate-400 text-xs mt-1 text-center">CH₂=CH-CH₂-CH₃</p>
            </div>
          </div>
        `;
        chemDisplay.classList.remove('hidden');
      } else if (q.formula) {
        chemDisplay.innerHTML = '<div class="chemical-formula">' + q.formula + '</div>';
        if (q.subtext) {
          chemDisplay.innerHTML += '<p class="text-white text-center mt-2">' + q.subtext + '</p>';
        }
        chemDisplay.classList.remove('hidden');
      } else if (q.hasBenzene) {
        chemDisplay.innerHTML = `
          <div class="flex justify-center items-center my-4">
            <div class="bg-slate-800/60 p-6 rounded-xl border border-yellow-400/30">
              <p class="text-yellow-300 text-sm mb-3 text-center font-semibold">Đáp án A:</p>
              <svg viewBox="0 0 200 120" class="w-48 h-auto mx-auto">
                <polygon points="100,20 130,35 130,65 100,80 70,65 70,35" 
                         fill="none" stroke="#fbbf24" stroke-width="2.5"/>
                <circle cx="100" cy="50" r="18" fill="none" stroke="#fbbf24" stroke-width="2"/>
                <line x1="100" y1="80" x2="100" y2="100" stroke="#fbbf24" stroke-width="2.5"/>
                <text x="85" y="115" fill="#fbbf24" font-size="14" font-family="Arial">CH</text>
                <line x1="100" y1="100" x2="120" y2="100" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="120" y1="100" x2="120" y2="85" stroke="#fbbf24" stroke-width="2.5"/>
                <line x1="120" y1="100" x2="135" y2="107" stroke="#fbbf24" stroke-width="2.5"/>
                <text x="138" y="112" fill="#fbbf24" font-size="14" font-family="Arial">CH₂</text>
                <text x="95" y="15" fill="#94a3b8" font-size="12" font-family="Arial">H</text>
                <text x="135" y="32" fill="#94a3b8" font-size="12" font-family="Arial">H</text>
                <text x="135" y="72" fill="#94a3b8" font-size="12" font-family="Arial">H</text>
                <text x="55" y="72" fill="#94a3b8" font-size="12" font-family="Arial">H</text>
                <text x="55" y="32" fill="#94a3b8" font-size="12" font-family="Arial">H</text>
              </svg>
              <p class="text-slate-400 text-xs mt-2 text-center">Styrene (C₆H₅-CH=CH₂)</p>
            </div>
          </div>
        `;
        chemDisplay.classList.remove('hidden');
      } else {
        chemDisplay.classList.add('hidden');
      }
      
      document.getElementById('question-info').textContent = set.name + ' - Câu ' + (currentQuestion + 1) + '/10 • ' + q.points + ' điểm';
      document.getElementById('attempt-info').textContent = 'Trả lời nhanh để có thêm thời gian cho câu tiếp theo!';
      document.getElementById('feedback').textContent = '';
      document.getElementById('next-btn').disabled = true;

      const answersDiv = document.getElementById('answers');
      answersDiv.innerHTML = '';
      
      q.answers.forEach((answer, i) => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'answer-btn bg-slate-700 hover:bg-slate-600 text-white p-3 rounded-lg text-left transition cursor-pointer';
        btn.textContent = answer;
        btn.onclick = () => checkAnswer(i);
        answersDiv.appendChild(btn);
      });

      answered = false;
    }

    function checkAnswer(index) {
      if (answered || !gameActive) return;

      const q = questionSets[currentSet].questions[currentQuestion];
      answered = true;

      const buttons = document.querySelectorAll('.answer-btn');
      
      buttons.forEach(btn => {
        btn.style.pointerEvents = 'none';
      });
      
      if (index === q.correct) {
        showFireworks();
        
        scores[currentTeam] += q.points;
        updateScores();
        
        buttons[index].style.backgroundColor = '#22c55e';
        buttons[index].style.borderColor = '#22c55e';
        
        document.getElementById('feedback').textContent = '✓ Chính xác! +' + q.points + ' điểm';
        document.getElementById('feedback').style.color = '#22c55e';
        
        setTimeout(() => {
          currentQuestion++;
          renderQuestion();
        }, 500);
      } else {
        shakePanel();
        
        buttons[index].style.backgroundColor = '#dc2626';
        buttons[index].style.opacity = '0.5';
        
        buttons[q.correct].style.backgroundColor = '#22c55e';
        buttons[q.correct].style.borderColor = '#22c55e';
        buttons[q.correct].style.border = '3px solid #22c55e';
        
        document.getElementById('feedback').textContent = '✗ Sai rồi! Đáp án đúng: ' + q.answers[q.correct];
        document.getElementById('feedback').style.color = '#f87171';
        
        setTimeout(() => {
          currentQuestion++;
          renderQuestion();
        }, 800);
      }
    }

    function nextQuestion() {
      if (!gameActive) return;
      currentQuestion++;
      renderQuestion();
    }

    function resetGame() {
      stopTimer();
      
      scores = [0, 0, 0, 0, 0, 0];
      currentTeam = null;
      currentSet = null;
      currentQuestion = 0;
      usedSets = new Set();
      answered = false;
      gameActive = false;
      timeRemaining = 30;

      updateScores();
      
      document.querySelectorAll('.set-card').forEach(card => {
        card.style.opacity = '1';
        card.style.pointerEvents = 'auto';
      });
      
      document.querySelectorAll('.team-btn').forEach(btn => {
        btn.classList.remove('team-selected');
      });

      document.getElementById('team-status').textContent = 'Chưa chọn lượt';
      document.getElementById('team-status').style.color = '#facc15';
      document.getElementById('set-status').textContent = 'Chưa chọn bộ câu hỏi';
      document.getElementById('set-status').style.color = '#facc15';

      renderQuestion();
    }

    // Initialize
    updateScores();
    renderQuestion();

    // Element SDK
    if (window.elementSdk) {
      const defaultConfig = {
        main_title: "Ai là học sinh chuyên Hóa",
        subtitle: "Trò chơi trắc nghiệm Hóa học",
        team_section_label: "Bước 2: Chọn bộ câu hỏi",
        question_section_label: "Câu hỏi hiện tại",
        scoreboard_label: "Bảng điểm",
        background_color: "#0f172a",
        surface_color: "#1e293b",
        text_color: "#ffffff",
        primary_color: "#22c55e",
        accent_color: "#facc15",
        font_family: "Roboto",
        font_size: 16
      };

      async function onConfigChange(config) {
        const cfg = Object.assign({}, defaultConfig, config);
        
        document.getElementById('main-title').textContent = cfg.main_title;
        document.getElementById('subtitle').textContent = cfg.subtitle;
        document.getElementById('team-section-label').textContent = cfg.team_section_label;
        document.getElementById('question-section-label').textContent = cfg.question_section_label;
        document.getElementById('scoreboard-label').textContent = cfg.scoreboard_label;
        document.getElementById('footer-text').textContent = cfg.footer_text;

        const baseFont = cfg.font_family + ", -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif";
        document.body.style.fontFamily = baseFont;
        
        const baseSize = cfg.font_size;
        document.getElementById('main-title').style.fontSize = (baseSize * 1.5) + 'px';
        document.getElementById('subtitle').style.fontSize = (baseSize * 0.875) + 'px';
      }

      window.elementSdk.init({
        defaultConfig: defaultConfig,
        onConfigChange: onConfigChange,
        mapToCapabilities: (config) => {
          const cfg = config || {};
          return {
            recolorables: [
              {
                get: () => cfg.background_color || defaultConfig.background_color,
                set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
              },
              {
                get: () => cfg.surface_color || defaultConfig.surface_color,
                set: (v) => { cfg.surface_color = v; window.elementSdk.setConfig({ surface_color: v }); }
              },
              {
                get: () => cfg.text_color || defaultConfig.text_color,
                set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
              },
              {
                get: () => cfg.primary_color || defaultConfig.primary_color,
                set: (v) => { cfg.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
              },
              {
                get: () => cfg.accent_color || defaultConfig.accent_color,
                set: (v) => { cfg.accent_color = v; window.elementSdk.setConfig({ accent_color: v }); }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => cfg.font_family || defaultConfig.font_family,
              set: (v) => { cfg.font_family = v; window.elementSdk.setConfig({ font_family: v }); }
            },
            fontSizeable: {
              get: () => cfg.font_size || defaultConfig.font_size,
              set: (v) => { cfg.font_size = v; window.elementSdk.setConfig({ font_size: v }); }
            }
          };
        },
        mapToEditPanelValues: (config) => {
          const cfg = Object.assign({}, defaultConfig, config);
          return new Map([
            ['main_title', cfg.main_title],
            ['subtitle', cfg.subtitle],
            ['team_section_label', cfg.team_section_label],
            ['question_section_label', cfg.question_section_label],
            ['scoreboard_label', cfg.scoreboard_label],
            ['footer_text', cfg.footer_text]
          ]);
        }
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9abd7ebe92118b69',t:'MTc2NTM3NzYwMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
